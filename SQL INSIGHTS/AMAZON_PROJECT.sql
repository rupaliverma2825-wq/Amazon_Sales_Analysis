DROP TABLE IF EXISTS AMAZON;

CREATE TABLE AMAZON (
	ORDER_ID VARCHAR(50),
	ORDER_DATE DATE,
	CUSTOMER_ID VARCHAR(50),
	CUSTOMER_NAME VARCHAR(50),
	PRODUCT_ID VARCHAR(50),
	PRODUCT_NAME VARCHAR(50),
	CATEGORY VARCHAR(50),
	BRAND VARCHAR(50),
	QUANTITY REAL,
	UNIT_PRICE REAL,
	DISCOUNT REAL,
	TAX REAL,
	SHIPPING_COST REAL,
	TOTAL_AMOUNT NUMERIC(10, 2),
	PAYMENT_METHOD VARCHAR(50),
	ORDER_STATUS VARCHAR(50),
	CITY VARCHAR(50),
	STATE VARCHAR(50),
	COUNTRY VARCHAR(50),
	SELLERID VARCHAR(50),
	MONTH VARCHAR(50),
	YEAR INT
);

SELECT
	*
FROM
	AMAZON;

-- DISTINCT PRODUCT NAMES -
SELECT DISTINCT
	PRODUCT_NAME
FROM
	AMAZON;

-- TOP 5 SELLING PRODUCTS

SELECT
	PRODUCT_NAME,
	SUM(TOTAL_AMOUNT) AS TOTAL
FROM
	AMAZON
GROUP BY
	PRODUCT_NAME,
	TOTAL_AMOUNT
ORDER BY
	TOTAL_AMOUNT DESC
LIMIT
	5;

-- SALES BY CATEGORY
SELECT
	CATEGORY,
	SUM(TOTAL_AMOUNT) AS TOTAL_AMOUNT
FROM
	AMAZON
GROUP BY
	CATEGORY
ORDER BY
	TOTAL_AMOUNT DESC;

-- TOP 5 SELLING BRANDS
SELECT
	BRAND,
	SUM(TOTAL_AMOUNT) AS TOTAL_AMOUNT
FROM
	AMAZON
GROUP BY
	BRAND
ORDER BY
	TOTAL_AMOUNT DESC
LIMIT
	5;

-- CUSTOMERS WITH MORE THAN 2 ORDERS IN 2024

SELECT
	CUSTOMER_ID,
	CUSTOMER_NAME,
	COUNT(*) AS ORDER_COUNT
FROM
	AMAZON
WHERE
	YEAR = 2024
GROUP BY
	CUSTOMER_ID,
	CUSTOMER_NAME
HAVING
	COUNT(*) > 2
ORDER BY
	ORDER_COUNT DESC;

-- CUSTOMERS WITH MORE THAN 2 ORDERS IN 2023

SELECT
	CUSTOMER_ID,
	CUSTOMER_NAME,
	COUNT(*) AS ORDER_COUNT
FROM
	AMAZON
WHERE
	YEAR = 2023
GROUP BY
	CUSTOMER_ID,
	CUSTOMER_NAME
HAVING
	COUNT(*) > 2
ORDER BY
	ORDER_COUNT DESC;

-- SALE IN 2024

SELECT
	PRODUCT_NAME,
	SUM(TOTAL_AMOUNT) AS TOTAL_AMOUNT
FROM
	AMAZON
WHERE
	YEAR = 2024
GROUP BY
	PRODUCT_NAME
ORDER BY
	TOTAL_AMOUNT DESC
LIMIT
	5;

-- SALE IN 2023

SELECT DISTINCT PRODUCT_NAME
FROM AMAZON ;

SELECT
	PRODUCT_NAME,
	SUM(TOTAL_AMOUNT) AS TOTAL_AMOUNT
FROM
	AMAZON
WHERE
	YEAR = 2023
GROUP BY
	PRODUCT_NAME
ORDER BY
	TOTAL_AMOUNT DESC
LIMIT
	5;

-- MAX PRICE OF PRODUCT 

SELECT
	PRODUCT_NAME,
	TOTAL_AMOUNT
FROM
	AMAZON
ORDER BY 
   TOTAL_AMOUNT DESC
LIMIT 1;

-- MIN PRICE OF PRODUCT 

SELECT
	PRODUCT_NAME,
	TOTAL_AMOUNT
FROM
	AMAZON
ORDER BY 
   TOTAL_AMOUNT
LIMIT 1;

-- HIGHEST DISCOUNT BY CATEGORY

SELECT
	CATEGORY,
	SUM(DISCOUNT) AS TOTAL_DISCOUNT
FROM
	AMAZON
GROUP BY
	CATEGORY
ORDER BY
	TOTAL_DISCOUNT DESC;

-- HIGHEST TAX PAID BY CATEGORY

SELECT
	CATEGORY,
	SUM(TAX):: NUMERIC AS TOTAL_TAX
FROM
	AMAZON
GROUP BY
	CATEGORY
ORDER BY
	TOTAL_TAX DESC;

-- TOP 5 PRODUCT WITH HIGHEST SHIPPING COST

SELECT
	PRODUCT_NAME,
	SUM(SHIPPING_COST) AS SHIPPING_COST
FROM
	AMAZON
GROUP BY
	PRODUCT_NAME
ORDER BY
	SHIPPING_COST DESC
LIMIT
	5;

-- MOST PREFERABLE PAYMENT METHOD BY CUSTOMERS

SELECT
	PAYMENT_METHOD,
	SUM(TOTAL_AMOUNT) AS TOTAL_AMOUNT
FROM
	AMAZON
GROUP BY
	PAYMENT_METHOD
ORDER BY
	TOTAL_AMOUNT DESC;

-- TOP COUNTRIES BY SALES
SELECT
	COUNTRY,
	SUM(TOTAL_AMOUNT) AS TOTAL_AMOUNT
FROM
	AMAZON
GROUP BY
	COUNTRY
ORDER BY
	TOTAL_AMOUNT DESC;

---- ORDER STATUS BREAKDOWN

SELECT ORDER_STATUS, COUNT (*)AS TOTAL
FROM AMAZON
GROUP BY ORDER_STATUS 
ORDER BY TOTAL DESC;












	